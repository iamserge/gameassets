App=App||{},App.Basket=App.Basket||{},App.Basket.PerfectPartners=new function(){$(function(){for(var a=$("#basketItems div.perfectPartners").find("a.perfectPartner"),b=0;b<a.length;b++)new App.Basket.QuickLook(a[b])})},App.Basket.MissedPromotions=new function(){$(function(){if(document.getElementById("basketItems"))for(var a=$("#basketItems div.missedPromotion"),b=0;b<a.length;b++){var c=$(a[b]),d=c.find("p.viewPromotions");if(d.length>0){var e=c.find("ul").addClass("hide");d.bind("click",{element:e},function(a){var b=a.data.element;return b.hasClass("hide")?b.removeClass("hide"):b.addClass("hide"),!1})}}})},App.Basket.FreeGiftExpired=new function(){function a(){if(document.getElementById("basketItems"))for(var a=$("#basketItems").find("div.freeGiftExpired"),d=0;d<a.length;d++){var e=$(a[d]);if(e.siblings().length>0){var f=e.find("div:first-child"),g=f.next();g.length>0&&(c="<div id='freeGiftExpiredOverlay'>"+g.html()+"</div>",g.remove(),f.bind("click",b))}}}function b(){return Adoro.Dialogue.setHtml(c),Adoro.Dialogue.showDialogue({showOverlay:!0,overlayOpacity:"0",closeOnOverlayClick:!0}),!1}var c="";$(a)},App.Basket.DeliveryOptions=new function(){function a(){d(),$("div#anonShippingMethods input.clickAndCollect").is(":checked")?($("a.changeLocation").css("display","inline-block"),"true"==$("input#CurrentClickAndCollect").val()&&(c(),$(".addressLookupForm .lookupBox").hide()),b()):$("a.changeLocation").css("display","none")}function b(){var a=Salmon.Global.CurrentPageStoreText.ccSelectedTitle;a&&(window.localStorage&&localStorage.getItem("clickAndCollectShopName")&&(a+=" <span>"+localStorage.getItem("clickAndCollectShopName")+"</span>"),$("#orderDeliveryAddress .header .title").html(a))}function c(){$("#deliveryLookup input").addClass("disabled"),$("#deliveryLookup input").on("keyup keydown change",function(a){a.preventDefault()})}function d(){var a=Salmon.Global.FeatureToggles.getFeature("NewCHECKOUT"),b=a?$('.deliveryOptions input[type="radio"]'):$("div#anonShippingMethods").find("input[type='radio']");b.bind("click",function(){if($("input[name="+this.name+"]").length>0){var b=this.value,c=this.id;$(this).hasClass("clickAndCollect")?Salmon.Global.DeliveryUpdate.AnonDeliveryUpdateForm($("#AnonCheckoutOrderDeliveryAddress"),b,c,!0):Salmon.Global.DeliveryUpdate.AnonDeliveryUpdateForm($("#AnonCheckoutOrderDeliveryAddress"),b,c,!1),a&&Salmon.Global.uiBlocker.blockUI()}})}$(a)},App.Basket.UpdateQuantityNew=function(){function a(){$('.basketSummary td.qty > input[type="number"]').on("change",function(){Salmon.Global.uiBlocker.blockUI(),console.log($(this).val()),$(this).closest("td").find(".js-submit").trigger("click")}),$(".basketSummary td.qty > button").on("click",function(a){a.preventDefault();var b=$(this),c=b.parent().find('input[type="number"]');b.hasClass("plus")?c.val(parseInt(c.val(),10)+1):c.val(parseInt(c.val(),10)-1),c.trigger("change")})}$(a)},App.Basket.ChuckABargain=new function(){function a(){var a=$("#chuckaBargain");a.find("li.productItem").length>0&&(new Salmon.Global.Truncator(a.find(Configuration.Basket.ChuckABargain.truncator.node),Configuration.Basket.ChuckABargain.truncator),a.find("form").unbind("submit"))}$(a)},App.Basket.newProceedButton=function(){function a(){var a=$(".btn.primary#signIn");a.on("click",function(a){a.preventDefault(),$('form[name="anonBasketForm"]').append('<input type="hidden" name="continueToCheckout" value="true" />').submit()})}$(a)},App.Basket.FormElements=new function(){function a(){new Salmon.Global.ButtonTrigger(document.getElementById("promoCode"),document.getElementById("applyCode")),new Salmon.Global.ButtonTrigger(document.getElementById("rewardCardNumberRedeem"),$("#rewardCardNumberRedeem").parent().find("input[type='submit']").get(0))}$(a)},App.Basket.Warranties=function(){function a(){b=$(".warrantyBasketContainer .checkboxes .addToBasket"),c=$(".warrantyBasketContainer .checkboxes .noWarranty"),b.on("change",function(a){b=$(this).siblings("input"),c=$(this).siblings(".noWarranty"),d(this)}),$(".warrantyBasketContainer .warrantyOverlayInner").each(function(){$(this).css("marginTop",-$(this).height()/2)}),Salmon.Global.Warranties.WarrantiesTermsOverlay()}var b,c,d=function(a){c.removeAttr("checked"),b.on("change",function(a){a.preventDefault()}),window.location=$(a).val()};$(a)},App.Basket.WarrantiesNew=function(){function a(){}$(a)},App.Basket.OverlayNew=function(){$("#checkoutSignIn.modal").on("click",function(a){(a.target===this||$(a.target).hasClass("closeModal"))&&$(this).fadeOut(function(){$(this).remove()})}),$(".warrantyContainer .warrantyInfo").on("click",function(a){a.preventDefault();var b=$(this).parent().parent().find(".warrantyEspotContainer");Salmon.Global.Modal.openModal(b.html())})},App.Basket.PromoCodeNew=function(){var a=$('form[name="anonBasketForm"]'),b=$(".discountContainer button");b.on("click",function(b){b.preventDefault(),a.append('<input type="hidden" name="submitPromotionalCode" value="Apply" />'),a.submit()})},App.Basket.WarrantiesNew(),App.Basket.UpdateQuantityNew(),App.Basket.newProceedButton(),App.Basket.OverlayNew(),App.Basket.PromoCodeNew(),App=App||{},App.Basket=App.Basket||{},App.Basket.ExpressCheckout=function(){function a(){$("#errorSummary").hasClass("hide")||$(document).scrollTop(50),window.location.href.indexOf("#payNow")>-1&&$(document).scrollTop(50),f(),b(),c(),d(),e()}function b(){var a=document.getElementById("deliveryAddress")||null;a&&new App.Basket.ExpressCheckoutForm(a)}function c(){var a=document.getElementById("payment")||null;a&&new App.Basket.ExpressCheckoutForm(a)}function d(){var a=document.getElementById("billing")||null;a&&new App.Basket.ExpressCheckoutForm(a)}function e(){var a=$("#wishlistAddresses");if(0!==a.length)for(var b=a.find("input[type='radio']"),c=0;c<b.length;c++){var d=$(b[c]),e=d.siblings("input[name='wishListDelivery']").addClass("hide");d.bind("click",function(){this.checked=!0,e.trigger("click")})}}function f(){var a=$("form").attr("action");$(document).ready(function(){$(".checkout-discounts :submit").bind("click",function(){$("form").attr("action",a+"#checkout-discounts")}),$(".checkout-delivery :radio").bind("click",function(){g=!1,$("form").attr("action",a+"#checkout-delivery")}),$("#payPalPayment").bind("click",function(){$("form").attr("action",a+"#payNow")}),$("#deliveryAddress").bind("click",function(){$("form").attr("action",a+"#checkout-delivery")}),$("#paymentDetails").bind("click",function(){$("form").attr("action",a+"#payNow")})})}var g;$(a),App.Basket.ExpressCheckoutForm=function(a){function b(){f.addClass("hide")}function c(){e.bind("change",function(){f.trigger("click")})}var d=$(a),e=d.find("select"),f=e.siblings("input[type='submit']");b(),c()}},App.Basket.FormValidator=function(){function a(){b()}function b(){var a=$("select#paymentDetails"),b=$("#paymentDetailsUpdate");b.length>0&&a.on("change",function(){c=!1,"change"!=a.val()&&(Salmon.Global.uiBlocker.blockUI(),b.trigger("click"))})}var c=!0;$(a)},App.Basket.ExpressCheckout.DeliveryOptionsNew=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=[],D="",E="",F=!1,G=!1,H="clickAndCollect",I="Collect+",J=!1,K="/webapp/wcs/stores/servlet/AJAXGetDeliveryPoints",L=function(){N(),M(),O(c.filter(":checked")),C.length>0&&(Salmon.Global.ChangeLocationNew.setupShops(C,G,w),V()),F?Q():R(),(D.length>0||E.length>0)&&F&&W(),S(),b.each(function(){0!==$(this).find('input[type="radio"]').length||$(this).hasClass("download")||v.hide()})},M=function(){D=f.length>0?f.val():"",E=g.length>0?g.val():"",w=j.length>0&&j.val().length>0?j.val():h.text(),j.val(w),"undefined"!=typeof sessionStorage&&(sessionStorage.getItem(D.replace(/ /g,"")+"_shop")?x=JSON.parse(sessionStorage.getItem(D.replace(/ /g,"")+"_shop")):sessionStorage.getItem(E.replace(/ /g,"")+"_shop")&&(x=JSON.parse(sessionStorage.getItem(E.replace(/ /g,"")+"_shop"))))},N=function(){a=$("#expressCheckoutDetails"),b=$(".shippingMethods"),c=$('#expressShippingMethods input[type="radio"]'),d=$(".changeLocation"),e=$("#defaultStoreName"),f=$("#selectedCCShop"),g=$("#selectedCCPlusShop"),h=$("#deliveryAddress .vcard .postal-code"),j=$("#newPostcode"),p=$("#deliveryAddress .home"),i=$("#deliveryAddress"),k=$("#deliveryAddress .ccAddress"),l=$("#deliveryAddress .changeLocation"),m=$('select[name="deliveryAddress"]'),n=$("#deliveryAddress .vcard"),o=$("#deliveryAddress .vcard_default"),q=$("#isCollectPlus"),r=$("#selectedShippingId"),s=$("#selectedShippingInfo"),v=$('.checkout-box-terms-and-payNow input[name="placeOrder"]'),t=$("#deliveryAddress .homeTitle"),u=$("#deliveryAddress .collectionTitle")},O=function(a){y=a.val(),z=a.attr("id"),J=F==a.hasClass("clickAndCollect"),F=a.hasClass(H),F?(G=z.indexOf(I)!=-1,t.hide(),u.show()):(t.show(),u.hide()),q.val(G)},P=function(){var a=$("<div />",{"class":"closestShop delivery"}),c="<h2>Home delivery to:</h2>";$(".closestShop.delivery").remove(),n.is(":visible")?a.html(c+n.html()):a.html(c+o.html()),b.each(function(){$(this).append(a)})},Q=function(){p.hide(),$(".closestShop.delivery").remove(),C.length>0&&(Salmon.Global.ChangeLocationNew.setupShops(C,G,w),W())},R=function(){p.show(),$(".closestShop.cc").remove(),e.hide(),k.hide(),m.show(),o.is(":visible")||(o.show(),n.hide()),P(),t.show(),u.hide()},S=function(){c.on("click",function(){O($(this)),r.val(y),s.val(z),F?(V(),Q()):R(),T()})},T=function(){F&&0===C.length?U():Salmon.Global.DeliveryUpdateExpress.DeliveryUpdateExpressForm(a,y,z,F)},U=function(){e.hide(),$.get(K+"?postalCode="+w,function(b){b&&Salmon.Global.ChangeLocationNew.setupShops(b.shops,G,w),C=b.shops,V(),"undefined"!=typeof A&&(D=A.shopName),"undefined"!=typeof B&&(E=B.shopName),W(),Salmon.Global.DeliveryUpdateExpress.DeliveryUpdateExpressForm(a,y,z,F)})},V=function(){if("undefined"!=typeof C&&C.length>0)for(var a in C){var b=C[a];if(b.isCollectPlus){if("undefined"==typeof B&&(B=b,"undefined"!=typeof A))break}else if("undefined"==typeof A&&(A=b,"undefined"!=typeof B))break}0===D.length&&"undefined"!=typeof A&&(D=A.shopName),0===E.length&&"undefined"!=typeof B&&(E=B.shopName)},W=function(){var a,c='<div class="closestShop cc"><h3>Collect from:<span>%shopName%</span><span class="milesAway">%miles%</span></h3><div>%address%</div><a href="#" class="btn secondary changeLocation">Choose another shop</a></div>',d=function(a){var b="",d="";if("undefined"==typeof a){if("undefined"==typeof x)return;a=x}b=c.replace("%shopName%",a.shopName),b=b.replace("%miles%",parseFloat(a.distance).toFixed(2)+" miles away");for(var e in a.address)a.address[e].length>0&&(d+=a.address[e]+", ");return d=d.substring(0,d.length-1),b=b.replace("%address%",d)},e="";$(".closestShop.cc").remove(),G?(a=E,g.val(a),e=d(B),B&&b.append(e)):(a=D,f.val(a),e=d(A),A&&b.append(e)),!A&&!B&&e.length>0&&"undefined"!=typeof x&&b.append(e),i.append(e)},X=function(a){C=a};return $(L),{setDefaultStores:X}},$(document).ready(function(){"pgBasket"==$("body").attr("id")&&$("body").hasClass("express")&&(App.Basket.ExpressCheckout(),App.Basket.FormValidator(),App.Basket.ExpressCheckout.DeliveryOptionsNew=App.Basket.ExpressCheckout.DeliveryOptionsNew())}),App.Basket.PromotionalCode=new function(){function a(){var a=$("#expressCheckoutDetails");$("#submitPromotionalCodeButton").on("click",function(b){b.preventDefault(),a.addClass("notValidate"),a.append('<input type="hidden" name="submitPromotionalCode" value="Apply" />'),a.submit()}),$("#submitEGiftcardNumberButton").on("click",function(b){b.preventDefault(),a.addClass("notValidate"),a.append('<input type="hidden" name="submitEGiftcardNumber" value="Apply" />'),a.submit()}),$("#promotionCode button").on("click",function(b){b.preventDefault(),a.addClass("notValidate"),a.append('<input type="hidden" name="submitPromotionalCode" value="Apply" />'),a.submit()})}$(a)};var App=App||{};App.Checkout=App.Checkout||{},App.Checkout.Anonymous=App.Checkout.Anonymous||{},App.Checkout.Anonymous.PersonalAndDeliveryDetailsValidatorNew=function(){var a=function(){var a={email:[{errorMessage:"Please enter your email address",rule:"email"}],confirmEmail:[{errorMessage:"Emails do not match. Please enter the same email",rule:function(a){return a==$(".labeledInputs #email").val()}}]},b=new Salmon.Global.Validation($("#AnonCheckoutOrderDeliveryAddress"),{specificValidationRules:a});b.validateOnClick($("#AnonCheckoutOrderDeliveryAddress #submitDetails"))};a()},App.Checkout.Anonymous.DeliveryTabsNew=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z="undefined"!=typeof Salmon.Global.InitialCCShops&&Salmon.Global.InitialCCShops.shops.length>0,A=z?Salmon.Global.InitialCCShops.shops:[],B=function(){C(),K(),D(),G(),L(),P(),J(),H(),E()},C=function(){a=$("#AnonCheckoutOrderDeliveryAddress"),b=$(".deliveryOrCollection > div"),d=$("#homeDeliveryTabButton"),n=$("#showHomeDeliveryOptions"),p=$("#collectionDeliveryPostcode"),o=$("#showCollectionOptions"),h=$(".section.address"),l=h.find('input[type="text"]'),k=$("#continueToPayment"),e=$("#deliveryLookup .tab"),r=$(".section.proceed"),c=$(".section.products"),m=$(".section.products"),f=$("#deliveryTypeTab"),i=$(".internationalButton"),j=$("input#internationalAddress"),q=$("#isCollectPlus"),s=$(".deliveryOptionsSubGroup")},D=function(){i.on("click",function(b){b.preventDefault(),"off"==j.val()?(a.addClass("notValidate"),j.val("on")):(F(),j.val("off")),a.submit()})},E=function(){if(!y){var a=$("#notRecipient").length>0?$("#orderDeliveryAddress"):$(".section.address");t=new Salmon.Global.Validation(a,{specificValidationRules:{postCode:[{errorMessage:"Please enter valid postcode",rule:"postcode"}]}}),t.validateOnClick(k)}},F=function(){h.find("input[name=address1]").val(""),h.find("input[name=address2]").val(""),h.find("input[name=address3]").val(""),h.find("input[name=town]").val(""),h.find("input[name=county]").val(""),h.find("input[name=postCode]").val("")},G=function(){n.on("click",function(b){if(b.preventDefault(),y){var c=new Salmon.Global.Validation($(".internationalAddressFields"),{});c.validate()&&a.append('<input type="hidden" name="showMyOptions" id="showMyOptions" value="true" />').submit()}else I($(this).parent().find('input[type="text"]'))&&a.append('<input type="hidden" name="showMyOptions" id="showMyOptions" value="true" />').submit()}),o.on("click",function(b){b.preventDefault(),"on"==j.val()&&(g.removeAttr("checked"),a.addClass("notValidate")),I($("#collectionDeliveryPostcode"))&&a.append('<input type="hidden" name="showMyOptions" id="showMyOptions" value="true" />').submit()}),k.on("click",function(b){b.preventDefault(),t.validate()&&a.append('<input type="hidden" name="continueToPayment" id="showMyOptions" value="true" />').submit()})},H=function(){y=j.length>0&&"on"==j.val(),e.eq(1-b.filter(".selected").index()).hide(),u=f.val(),v="collection"==u,l.length>0&&(v?(M(l),N()):h.hasClass("noResults")||M(h.find('[name="postCode"]'))),x=p.val(),0===$(".deliveryOrCollection .active").length?(e.hide(),c.hide(),r.hide(),h.hide(),$("#collectionTabButton").hasClass("disabled")&&$("#homeDeliveryTabButton").trigger("click")):d.hasClass("active")?e.eq(1).hide():e.eq(0).hide(),(y||v)&&0===m.find('input[type="radio"]').length&&r.hide(),0===m.find('input[type="radio"]').length&&m.hide()},I=function(a){var b=/^[A-Z]{1,2}[0-9R][0-9A-Z]? ?[0-9][ABD-HJLNP-UW-Z]{2}$/;return a.siblings(".error").remove(),a.length>0&&a.val().length>0?!!b.test(a.val().replace(/ /g,"").toUpperCase())||(a.after('<span class="error">Please enter valid postcode</span>'),a.addClass("errorInput"),a.focus(),a.on("keyup",function(){b.test(a.val().replace(/ /g,"").toUpperCase())?(a.removeClass("errorInput"),a.parent().find(".error").hide()):(a.addClass("errorInput"),a.parent().find(".error").show(),a.focus())}),void 0):(a.after('<span class="error">Please enter valid postcode</span>'),a.addClass("errorInput"),a.focus(),a.on("keyup",function(){b.test(a.val().replace(/ /g,"").toUpperCase())?(a.removeClass("errorInput"),a.parent().find(".error").hide()):(a.addClass("errorInput"),a.parent().find(".error").show(),a.focus())}),!1)},J=function(){b.on("click",function(a){a.preventDefault(),u=$(this).attr("id").replace("TabButton",""),$(this).parent().find(".active").removeClass("active"),$(this).addClass("active"),e.hide(),f.val(u),$(e[$.inArray(this,b)]).show(),$(this).find('input[type="radio"]').prop("checked",!0),$(".section.products").hide(),$(".section.address").hide(),$(".section.addressSelection").hide(),r.hide()})},K=function(){var a=$("#selectAddressFromPostcode"),b=$("#continueToPayment"),c=function(a){var b=d(a);for(var c in b)h.find('input[name="'+c+'"]').val(b[c]);0!==b.county.length&&" "!==b.county||h.find('input[name="county"]').val(b.town)},d=function(a){var b=a.split("|"),c={};for(var d in b)c[b[d].split(":")[0]]=b[d].split(":")[1];return"undefined"!=typeof c.city&&(c.town=c.city,delete c.city),c};a.length>0&&(h.is(":visible")||""===a.val()?(h.hide(),b.hide(),m.hide()):(h.show(),b.show(),m.show()),a.on("change",function(){c($(this).val()),h.find('[name="postCode"]').attr("readonly",!0).addClass("disabled"),h.is(":visible")||(h.show(),b.show(),m.show()),""===a.val()&&(h.hide(),b.hide(),m.hide())}))},L=function(){$('div#anonShippingMethods input[type="radio"]').on("click",function(){v&&N()})},M=function(a){a.attr("readonly",!0).addClass("disabled")},N=function(){var a=m.find(".changeLocation"),b=$("#defaultStoreName"),d='<div class="closestShop"><h3>from <span>%shopName%</span><span class="milesAway">%miles%</span></h3><div>%address%</div><a href="#" class="btn secondary changeLocation">Choose another shop</a></div>',e={},f=function(a){var b="",c="";b=d.replace("%shopName%",a.shopName),b=b.replace("%miles%",parseFloat(a.distance).toFixed(2)+" miles away");for(var e in a.address)a.address[e].length>0&&(c+=a.address[e]+", ");return c=c.substring(0,c.length-1),b=b.replace("%address%",c)},g=function(){for(var a in e.address)h.find('input[name="'+a+'"]').val(e.address[a]);$(".deliveryOptions").find('input[type="radio"]:checked').parent().after(f(e))};w=m.find('input[type="radio"]').length>0?m.find('input[type="radio"]').filter(":checked").hasClass("clickAndCollectPlus"):void 0,z&&(e=A.filter(O)[0]),a.css("display","inline-block"),b.css("display","inline-block"),q.val(w),g(),window.addEventListener("shopSelectedEvent",function(a){var b=a.detail;c.find(".closestShop").replaceWith(f(b))},!1),A.length>0&&Salmon.Global.ChangeLocationNew.setupShops(A,w,p.val())},O=function(a){return("string"==typeof a.isCollectPlus?"true"==a.isCollectPlus:a.isCollectPlus)==w},P=function(){var a,b,c=$("#shareLocationButton"),d=$("#collectionDeliveryPostcode"),e=!1,f=function(a){"undefined"!=typeof a&&g(a.coords.latitude,a.coords.longitude)},g=function(a,b){var c="https://maps.googleapis.com/maps/api/geocode/json?key=AIzaSyDcpqci0Z0_bZqS6Tw8piP1hDrr2C-mIpI&result_type=postal_code";$.get(c+"&latlng="+a+","+b,function(a){h(a)})},h=function(a){if("undefined"!=typeof a&&"undefined"!=typeof a.results&&a.results.length>0){for(var b=0,c="";b<a.results.length-1;){var e=a.results[b];for(var f in e.address_components)if(("postal_code"==e.address_components[f].types[0]||"postal_code_prefix"==e.address_components[f].types[0])&&e.address_components[f].long_name.length>4){c=a.results[b];break}b++}""!=c?(d.val(c.address_components[0].long_name),"undefined"!=typeof google&&i(c),j()):alert("We cannot process your location into postcode. Please enter postcode manually")}},i=function(b){var f={zoom:15},g="closestPostcodeMap";a=$("<div />",{id:g}),d.parent().before(a),Salmon.Global.uiBlocker.removeLoader(c),c.removeClass("loading"),f.center=new google.maps.LatLng(b.geometry.location.lat,b.geometry.location.lng);var h=new google.maps.Map($("#"+g)[0],f),i=new google.maps.Marker({icon:Salmon.Global.PageContext.IMAGEPATH+"markers/image.png",position:f.center,title:b.address_components[0].long_name});i.setMap(h),e=!0},j=function(){b=$("<a />",{id:"notMyLocation",href:"#",text:"Not correct location?"}),d.parent().before(b),$(document).on("click","#notMyLocation",function(a){a.preventDefault(),e=!1,k()})},k=function(){b.remove(),a&&a.slideToggle(function(){a.remove()}),d.val(""),d.focus()},l=function(){c.hide()};c.on("click",function(a){a.preventDefault(),e||(Salmon.Global.uiBlocker.insertLoader(c),c.addClass("loading")),navigator.geolocation&&!e&&navigator.geolocation.getCurrentPosition(f,l)})},Q=function(a,b){A=a,x=b};return B(),{setNewShopsAndPostcode:Q}},$(document).ready(function(){App.Checkout.Anonymous.DeliveryTabsNew=App.Checkout.Anonymous.DeliveryTabsNew(),App.Checkout.Anonymous.PersonalAndDeliveryDetailsValidatorNew()});var App=App||{};App.Checkout=App.Checkout||{},App.Checkout.Confirmation=App.Checkout.Confirmation||{},App.Checkout.Confirmation.Controller=new function(){function a(){document.getElementById("privacyPolicy")&&new App.Global.StaticPageOverlay(document.getElementById("privacyPolicy"))}$(a)},App.Checkout.Confirmation.sellerDeliveryDetailsOverlay=new function(){function a(){var a="",b="";$(".overlay").click(function(e){e.preventDefault(),d=$(this),a=$(this).attr("href"),b=$(a).clone(),void 0!==$(this).parents("td").data("order")&&(f=$(this).parents("td").data("order")),$(this).hasClass("sellerDeliveryCTA")&&(b=c(b),console.log("overlay content "+$(b))),$(".closeOverlay").click(function(a){a.preventDefault(),Adoro.Dialogue.hideDialogue()})})}function b(a){var b,c="";return e=$(a).html(),Adoro.Dialogue.setHtml(e),""!==f&&(null!==$("#dialogue").find(".overlayContent")&&(b=$("#dialogue").find(".overlayContent")),""!==b.html()&&null!==b.html()&&($(b).data("order",f),c=$(b).data("order"))),Adoro.Dialogue.showDialogue({showOverlay:!0,overlayOpacity:"0.8",closeOnOverlayClick:!0}),f="",!1}function c(a){var c=new App.Global.Ajax,d="/webapp/wcs/stores/servlet/AJAXMarketplaceSellerDeliveryDetails",e={};e=f.vendorShopId?{vendorShopId:f.vendorShopId}:{vendorShopId:"0000"};var g,h=$(a).find("img"),i=$(a).find(".rating"),j="";c.getData("GET",d,e,function(c){if(200==c.status){g=JSON.parse(c.content.replace("/*","").replace("*/","")),$(a).find(".sellerName").html(g.supplier.name),$(h).attr("src",Salmon.Global.PageContext.MARKETPLACE_SELLER_LOGO_URL_LARGE+f.vendorShopId+".png");var d=g.supplier.ratingStars%1===0?g.supplier.ratingStars:5*Math.round(10*g.supplier.ratingStars/5);i.attr("class","rating rating"+d),$(a).find(".ratingCount").html("("+g.supplier.ratingCount+")"),$(a).find(".sellerInfo").html(g.supplier.sellerInfo);for(var e=JSON.parse(g.shipping),k=0;k<e.length;k++)j+='<tr><th scope="row">'+e[k].region+"</th><td>"+e[k].label+" </td></tr>";$(a).find("tbody").html(j),b(a)}else App.PDP.Marketplace.Data.error="Sorry an error occured"})}var d,e="",f="";$(a)};var App=App||{};App.Checkout=App.Checkout||{},App.Checkout.AddressLookup=new function(){function a(){if(!document.getElementById("forceBillingLookup")&&document.getElementById("existingAddress")&&document.getElementById("billingLookup")){var a=$("#billingLookup").addClass("hide"),b=$("#exisitingAddress ul.action"),c=document.getElementById("useDifferentBillingAddress")||document.getElementById("useDifferentForBilling")||null;if(c){var d=$("#useShippingForBilling"),e=!document.getElementById("pageAnchor");a.removeClass(d.attr("checked")?"":"hide"),b.addClass(d.attr("checked")&&e?"hide":""),$(c).bind("click",function(){a.removeClass("hide"),b.addClass(e?"hide":"")}),$("input[id^='selectedBillingAddressId'], #useShippingForBilling").bind("click",function(){b.removeClass("hide")})}}}$(a)},App.Checkout.GiftCard=new function(){function a(){var a=$("#yourPaymentDetails").children("#giftCardSection").children(".field.input").children(".element");$(a).children("span.helpLink").children("a").bind("click",function(){var a=$(this).siblings("div");return $(a).hasClass("active")?$(a).removeClass("active"):$(a).addClass("active"),!1}),$("#giftCardSection").find("input[type=submit]").bind("click",b)}function b(){var a=!1,b=$(this).parents("div.element").children("input[type=text]").val(),c=$(this).parents("div.element").children(".errorSummary");return $(c).removeClass("active"),""===b?$(c).addClass("active"):a=!0,a}$(a)},App.Checkout.Vouchers=new function(){function a(){var a=$("#yourPaymentDetails").children("#eVoucherSection").children(".field.input").children(".element");$(a).children("span.helpLink").children("a").bind("click",function(){var a=$(this).siblings("div");return $(a).hasClass("active")?$(a).removeClass("active"):$(a).addClass("active"),!1}),$("#eVoucherSection").find("input[type=submit]").bind("click",b)}function b(){var a=!1,b=$(this).parents("div.element").children("input[type=text]").val(),c=$(this).parents("div.element").children(".errorSummary");return $(c).removeClass("active"),""===b?$(c).addClass("active"):a=!0,a}$(a)},App.Checkout.Promotion=new function(){function a(){var a=$("#promotionalCode").children(".field.input").children(".element");$(a).children("span.helpLink").children("a").bind("click",function(){var a=$(this).siblings("div");return $(a).hasClass("active")?$(a).removeClass("active"):$(a).addClass("active"),!1}),$("#promotionalCode").find("input[type=submit]").bind("click",b);var c=function(a){a.preventDefault(),alert("Please accept our terms and conditions")},d=function(a){a.preventDefault(),alert("Please enter the three digit security code on the back of your card")};if($("div.ageRestricted").length>0){var e=$("#placeOrder"),f=new Salmon.Global.Validation($("div.ageRestricted"),{});f.validateOnClick(e)}if(window.location.toString().indexOf("ExpressOrderItemDisplay")>-1||window.location.toString().indexOf("ExpressNewPayment")>-1){var g=function(){var a=$("#totalBalanceToPay"),b=$("#selectedTotalToPay");if(a.length>0&&"undefined"!=typeof a.text()&&b.length>0&&"undefined"!=typeof b.text())return 0==parseFloat(a.text().replace("£",""))&&0==parseFloat(b.text().replace("£",""))};$("input[name=placeOrder]").on("click",function(a){g()||0==$("#fieldCV2_2").length||$("#fieldCV2_2").val().length>=3&&$("#fieldCV2_2").val().length<=4&&$.isNumeric($("#fieldCV2_2").val())?$("#terms").is(":checked")?"undefined"!=typeof f?f.validate()&&($("form").append("<input type='hidden' name='placeOrder' value='true' />"),$("form").submit()):($("form").append("<input type='hidden' name='placeOrder' value='true' />"),$("form").submit()):c(a):d(a)}),$("form #placeOrderPaypal_2 input[name=placeOrderPaypal]").on("click",function(a){$("#terms").is(":checked")?($("form").append("<input type='hidden' name='placeOrderPaypal' value='true' />"),$("form").submit()):c(a)}),$("form #placeOrderPaypal_2 input[name=placeOrderWallet]").on("click",function(a){$("#terms").is(":checked")?($("form").append("<input type='hidden' name='placeOrderWallet' value='true' />"),$("form").submit()):c(a)})}else $("input[type=submit][name=createPayment]").on("click",function(a){$("#terms").is(":checked")?$("form").append("<input type='hidden' name='createPayment' value='true' />"):(a.preventDefault(),c(a))}),$("#payPalPayment[type=button][name=usePayPal]").on("click",function(a){$("#terms").is(":checked")?($("form").append("<input type='hidden' name='usePayPal' value='true' />"),$("form").submit()):c(a)}),$("input[name=placeOrder]").on("click",function(a){$("#terms").is(":checked")?($("form").append("<input type='hidden' name='placeOrder' value='true' />"),$("form").submit()):c(a)}),$("#walletPayment[type=button][name=useWallet]").on("click",function(a){$("#terms").is(":checked")?($("form").append("<input type='hidden' name='useWallet' value='true' />"),$("form").submit()):c(a)})}function b(){var a=!1,b=$(this).parents("div.element").children("input[type=text]").val(),c=$(this).parents("div.element").children(".errorSummary");return $(c).removeClass("active"),""==b?$(c).addClass("active"):a=!0,a}$(a)};var App=App||{};App.Checkout=App.Checkout||{},App.Checkout.DeliveryAddressNew=function(){var a=function(){var a=$("#addressOptions"),b=$("#selectMultiAddress");a.length>0&&a.find("option").length>0&&a.on("change",function(){a.val().length>0&&(Salmon.Global.uiBlocker.blockUI(),b.trigger("click"))})},b=function(){var a=$("#lookupCountry").length>0?$("#lookupCountry"):$("select#country"),b=a.siblings("input[type='submit']").hide();a.bind("change",function(){b.trigger("click")})};b(),a();var c=new Salmon.Global.Validation($(".addressFields"),{});c.validateOnClick($('input[name="createAddress"]'));var d=new Salmon.Global.Validation($("#deliveryLookup > .field.postCode"),{addErorMessageToParent:!0});d.validateOnClick($('input[name="doPostCodeLookup"]'))},$("body").hasClass("delivery")&&App.Checkout.DeliveryAddressNew();var App=App||{};App.Checkout=App.Checkout||{},App.Checkout.PaymentDetailsFormValidatorNew=function(){var a=$("#newPayment"),b=function(){$("#payWithPaypalButton").on("click",function(b){b.preventDefault(),validate=!1,a.append('<input type="hidden" name="usePayPal" value="PayPal" />'),a.submit()}),$("#payWithGAMEWalletButton").on("click",function(b){b.preventDefault(),validate=!1,a.append('<input type="hidden" name="useWallet" value="GAMEWallet" />'),a.submit()}),$("#submitPromotionalCodeButton").on("click",function(b){b.preventDefault(),validate=!1,a.append('<input type="hidden" name="submitPromotionalCode" value="Apply" />'),a.submit()}),$("#submitEGiftcardNumberButton").on("click",function(b){b.preventDefault(),validate=!1,a.append('<input type="hidden" name="submitEGiftcardNumber" value="Apply" />'),a.submit()})},c=function(){var b={account:[{errorMessage:"Please enter valid card number",rule:function(a){return/^-?(\d+\.?\d*)$|(\d*\.?\d+)$/.test(a)}}],postCode:[{errorMessage:"Please enter valid postcode",rule:"postcode"}]},c=new Salmon.Global.Validation(a,{specificValidationRules:b,addErorMessageToParent:!0});c.validateOnClick($('#newPayment input[name="createPayment"]'))},d=function(){var a=new Salmon.Global.Validation($("#newPayment .billingAddress .labeledInputs"),{addErorMessageToParent:!0,specificValidationRules:{postCode:[{errorMessage:"Please enter valid postcode",rule:"postcode"}]}});a.validateOnClick($('#newPayment input[name="doPostCodeLookup"]'))},e=function(){var a=$(".billingAddress #zipCode"),b=$(".addressFields #postCode");b.length>0&&b.val().length>0&&a.is(":visible")&&a.val(b.val()),$('#newPayment input[name="createPayment"]').on("click",function(){b.length>0&&a.is(":visible")&&a.val(b.val())})};e(),b(),c(),d()},App.Checkout.BillingAddressCheckboxController=function(){var a=$("#useShippingForBilling"),b=$(".section.billingAddress");a.is(":checked")&&b.hide(),a.on("change",function(){b.slideToggle()})},App.Checkout.SelectAddressController=function(){var a=$("#addressOptions"),b=$("#selectMultiAddress");$(".radioList.addresses").length>0&&a.length>0&&a.find("option").length>0&&($("html, body").animate({scrollTop:$(".radioList.addresses").offset().top+100}),a.on("change",function(){a.val().length>0&&(Salmon.Global.uiBlocker.blockUI(),b.trigger("click"))}))},App.Checkout.CardTypeRecognizer=function(){var a=$("#cardNumber"),b=$("#cardType"),c=function(a){var b={electron:/^(4026|417500|4405|4508|4844|4913|4917)\d+$/,maestro:/^(5018|5020|5038|5612|5893|6304|6759|6761|6762|6763|0604|6390)\d+$/,visa:/^4[0-9]{12}(?:[0-9]{3})?$/,mastercard:/^5[1-5][0-9]{14}$/};return b.electron.test(a)?"11107":b.maestro.test(a)?"11104":b.visa.test(a)?"11101":b.mastercard.test(a)?"11102":void 0};a.on("change blur",function(){var a=c($(this).val());"undefined"!=typeof a&&(b.val(a),b.trigger("change"))})},App.Checkout.AddNewCardController=function(){var a=$("#selectBillingAddress"),b=$(".addNewContainer a"),c=$(".addressSelectedContainer"),d=$(".addCardBottomContainer"),e=$("#addressOptions"),f=$(".addressFields"),g=$("form#newPayment"),h=function(){var a={account:[{errorMessage:"Please enter valid card number",rule:function(a){return/^-?(\d+\.?\d*)$|(\d*\.?\d+)$/.test(a)}}]},b=new Salmon.Global.Validation(g,{specificValidationRules:a,addErorMessageToParent:!0});b.validateOnClick($('#newPayment input[name="createPayment"]'))},i=function(){var a=new Salmon.Global.Validation($("#newPayment .billingAddress .labeledInputs"),{
addErorMessageToParent:!0});a.validateOnClick($('#newPayment input[name="doPostCodeLookup"]'))},j=function(){var a=$("#zipCode"),b=$(".addressFields #postCode");b.length>0&&b.val().length>0&&a.val(b.val())};"-"!=a.val()&&0==e.length&&0==d.length?f.hide():e.length>0&&e.find("option").length>0&&$("html, body").animate({scrollTop:f.offset().top-50}),a.on("change",function(){"-"==a.val()?(f.slideDown(),c.hide(),$("html, body").animate({scrollTop:f.offset().top-50})):(f.slideUp(),c.show())}),b.on("click",function(b){b.preventDefault(),a.val("-"),f.slideToggle()}),h(),i(),j()},App.Checkout.FormErrors=function(){var a=$(".field.fieldError");a.length>0&&a.find("input").on("change",function(){$(this).parent().removeClass("fieldError"),$(this).parent().find(".errorMessage").hide()})},$(document).ready(function(){var a="pgExpressPayment"==$("body").attr("id");a||App.Checkout.PaymentDetailsFormValidatorNew(),App.Checkout.BillingAddressCheckboxController(),App.Checkout.SelectAddressController(),App.Checkout.CardTypeRecognizer(),App.Checkout.FormErrors(),a&&App.Checkout.AddNewCardController()});
//# sourceMappingURL=checkout.min.js.map